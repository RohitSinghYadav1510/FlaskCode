pipeline {
   agent none
  stages {

     stage('Test Application') {
            agent {
               docker {
                 image 'rohit1015/flaskimg:v1'
               }
           } 
            steps {
              sh 'python test.py'
              }
            post {
              always {
                 junit 'test-reports/*.xml'
               }
            }    
        }
      stage('sonar'){
           sh 'docker run --rm --net=host -v (PWD):/sonarqube-flask sonarsource/sonar-scanner-cli sonar-scanner -D sonar.projectBaseDir=/var/lib/jenkins/workspace/flaskseco'
      }  
   }
}