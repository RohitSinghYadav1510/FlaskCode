pipeline {
   agent any

  stages {

     stage('Test Application') {
            agent {
               docker {
                 image 'rohit1015/flaskimg:v1'
               }
           } 
            steps {
              sh 'python test.py'
              }
            post {
              always {
                 junit 'test-reports/*.xml'
               }
            }    
        }
     stage('sonar'){
          steps {
           sh 'docker run --rm --net=host -v (PWD):/var/lib/jenkins/workspace/flaskseco sonarsource/sonar-scanner-cli sonar-scanner -D sonar.projectBaseDir=/var/lib/jenkins/workspace/flaskseco'
        } 
     }  
   }
}